<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FoodieGoodies</title>
    <link href="images/logo.png" type="image/x-icon" rel="icon" />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />

    <!-- Template Stylesheet -->
    <link href="./css/style.css" rel="stylesheet" />

    <!-- Custom Stylesheet for Preload Page -->
    <link href="./css/preloadStyle.css" rel="stylesheet" />

    <!-- Custom Tab Icon -->
    <link href="../public/images/favicon.ico" rel="icon" />

    <!-- Vue -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  </head>

  <body>
    <!-- Topbar Start -->
    <div class="container-fluid px-3 d-lg-block bgTopBar" id="app">
      <div class="row py-4 align-items-center">
        <div class="col-sm-3">
          <div
            class="d-flex align-items-center justify-content-sm-start justify-content-center"
          >
            <a href="index.html">
              <img
                src="images/logo.png"
                alt="FoodieGoodies Website Logo"
                style="height: 80px; width: 80px"
              />
            </a>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="d-flex align-items-center justify-content-center">
            <h1>
              <span class="basic1">Foodie </span
              ><span class="basic2">Goodies</span>
            </h1>
          </div>
        </div>
        <div class="col-sm-3">
          <div
            class="d-flex align-items-center justify-content-sm-end justify-content-center"
          >
            <!-- Login Pop Up Button Start -->
            <button
              type="button"
              class="btn btn-success me-1"
              data-bs-toggle="modal"
              data-bs-target="#loginModal"
            >
              Login
            </button>
            <!-- Login Pop Up Button End -->

            <!-- Login Modal Start -->
            <div
              class="modal fade"
              id="loginModal"
              tabindex="-1"
              aria-labelledby="loginModal"
              aria-hidden="true"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="loginModal">Login Form</h1>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <!-- Login Form Content Start -->
                  <div class="modal-body">
                    <!-- Email input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="loginEmail">Email</label>
                      <input
                        type="email"
                        id="loginEmail"
                        v-model="loginEmail"
                        class="form-control"
                        placeholder="Enter Email"
                      />
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="loginPassword"
                        >Password</label
                      >
                      <input
                        type="password"
                        id="loginPassword"
                        v-model="loginPassword"
                        class="form-control"
                        placeholder="Enter Password"
                      />
                    </div>
                  </div>

                  <!-- Login Form Content End -->
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>

                    <!-- Login button -->
                    <input
                      type="submit"
                      @click="login()"
                      class="btn btn-success"
                      value="Login"
                    />

                    <!-- User Registration Status -->
                    <p id="status" class="mt-3"></p>
                  </div>
                </div>
              </div>
            </div>
            <!-- Login Modal End -->

            <!-- Sign Up Pop Up Button Start -->
            <button
              type="button"
              class="btn btn-outline-success"
              data-bs-toggle="modal"
              data-bs-target="#signUpModal"
            >
              Sign Up
            </button>
            <!-- Sign Up Pop Up Button End -->

            <!-- Sign Up Modal Start -->
            <div
              class="modal fade"
              id="signUpModal"
              tabindex="-1"
              aria-labelledby="signUpModal"
              aria-hidden="true"
            >
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="signUpModal">
                      Sign Up Form
                    </h1>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <!-- Sign Up Form Content Start -->
                  <div class="modal-body">
                    <!-- Name input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="registerName">Name</label>
                      <input
                        type="text"
                        id="registerName"
                        v-model="registerName"
                        class="form-control"
                        placeholder="Enter Name"
                      />
                    </div>

                    <!-- Email input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="registerEmail"
                        >Email</label
                      >
                      <input
                        type="email"
                        id="registerEmail"
                        v-model="registerEmail"
                        class="form-control"
                        placeholder="Enter Email"
                      />
                    </div>

                    <!-- Password input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="registerPassword"
                        >Password</label
                      >
                      <input
                        type="password"
                        id="registerPassword"
                        v-model="registerPassword"
                        class="form-control"
                        placeholder="Enter Password"
                      />
                    </div>

                    <!-- Confirm Password input -->
                    <div class="form-outline mb-4">
                      <label class="form-label" for="registerRepeatPassword"
                        >Confirm password</label
                      >
                      <input
                        type="password"
                        id="registerConfirmPassword"
                        v-model="registerConfirmPassword"
                        class="form-control"
                        placeholder="Enter Password Again"
                      />
                    </div>
                  </div>

                  <!-- Sign Up Form Content End -->
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Close
                    </button>

                    <!-- Submit button -->
                    <input
                      type="submit"
                      @click="signUp()"
                      class="btn btn-success"
                      value="Sign Up"
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- Sign Up Modal End -->
          </div>
        </div>
      </div>
    </div>
    <!-- Top bar end -->

    <!-- [Section 1] Statistics Start -->
    <div class="container-fluid">
      <div class="row section1Img position-relative">
        <div class="col caption position-absolute">
          <h3>
            Each year, 40% of food waste are generated by commercial retailers
            such as restaurants.
          </h3>
          <caption>
            Source: National Environment Agency (NEA)
          </caption>
        </div>
      </div>
    </div>
    <!-- [Section 1] Statistics End -->

    <div class="container-fluid bgtheme">
      <!-- [Section 2] Feature 1 Start -->
      <div class="row">
        <div class="col-sm section2Img m-1"></div>
        <div
          class="col-sm bgBasic1 m-1 p-3"
          style="text-align: justify; color: whitesmoke"
        >
          <h2 style="text-align: center">Up for a sustainability challenge?</h2>

          <p class="m-5">
            Every day, your favourite restaurants throws aways food just because
            it is blemish or unsold. We enable conscious consumer, like you, to
            be a sustainable hero and save these foods from going to waste.
          </p>

          <h5 style="text-align: center">Saving both food and your money!</h5>
        </div>
      </div>
      <!-- [Section 2] Feature 1 End -->

      <!-- [Section 3] Feature 2  Start -->
      <div class="row">
        <div class="col-sm section3Img m-1"></div>
        <div class="col-sm basic2 m-1 p-3" style="background-color: whitesmoke">
          <h3 style="text-align: center">How FoodieGoodies Works?</h3>

          <ol class="m-5" style="text-align: justify">
            <li>
              Simply log on to FoodieGoodies and search for your preferred
              restaurant.
            </li>
            <li>
              Confirm your order and reserve your mystery box. To collect, go to
              the restaurant at the designated pick-up time.
            </li>
            <li>
              Go home, explore your mystery box and enjoy your meal. You have
              just saved a box of food from going to waste!
            </li>
          </ol>
        </div>
      </div>
      <!-- [Section 3] Feature 2 End -->
    </div>

    <!-- import index.js -->
    <script type="module">
      import {
        db,
        auth,
        createUserWithEmailAndPassword,
        set,
        ref,
        signInWithEmailAndPassword,
        update,
        onAuthStateChanged,
        onValue,
      } from "./index.js";

      const app = Vue.createApp({
        data() {
          return {
            loginEmail: "",
            loginPassword: "",
            registerName: "",
            registerEmail: "",
            registerPassword: "",
            registerConfirmPassword: "",
          };
        },
        methods: {
          // login function
          login() {
            signInWithEmailAndPassword(
              auth,
              this.loginEmail,
              this.loginPassword
            )
              .then((userCredential) => {
                const dt = new Date();
                const user = userCredential.user;
                console.log(user);
                update(ref(db, "users/" + user.uid), {
                  last_login: dt,
                }).then((data) => {
                  location.href = "landingPage.html";
                });
                alert("User logged in");
              })
              .catch((error) => {
                alert(error.message);
              });
          },

          // signUp function
          signUp() {
            if (this.registerPassword !== this.registerConfirmPassword) {
              alert("Passwords are not the same!");
              return;
            }
            createUserWithEmailAndPassword(
              auth,
              this.registerEmail,
              this.registerPassword
            )
              .then((userCredential) => {
                let signUpUser = userCredential.user;
                alert("User Created!");
                set(ref(db, "users/" + signUpUser.uid), {
                  name: this.registerName,
                  email: this.registerEmail,
                });
              })
              .catch((error) => {
                var errorMessage = error.message;
                alert(errorMessage);
              });
          },
        },
      });
      const vm = app.mount("#app");
    </script>

    <!-- Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
